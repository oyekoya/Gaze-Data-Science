function readpresenccialog
scrsz = get(0,'ScreenSize');
figure('Position',scrsz);
%F:/presenccia/ubitrack/branches/dtg_demo/participant02.log
DTG = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003d2f00000e000000fe49c0fa4a00003f0c000000000100000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
UCL = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000070000000010102000e0000003132382e31362e31332e313639003c2f1c000000ff70657273697374656e7420706f6100e6d8fa4a01000d14000000000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
XIM = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003b2f000010000000ff426964446972504f410031303131300200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
analyselog('F:/presenccia/ubitrack/branches/dtg_demo/participant02.log',0,UCL,DTG,XIM);

%analyselog('F:/presenccia/ubitrack/branches/dtg_demo/participant03.log');
%analyselog('F:/presenccia/ubitrack/branches/dtg_demo/participant04.log');

%F:/presenccia/ubitrack/branches/dtg_demo/participant05.log
XIM = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003b2f000010000000ff426964446972504f410031303133360200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
DTG = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003e2f00000e000000fe7515fc4a00005ddd000000000100000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
UCL = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000070000000010102000e0000003132382e31362e31332e313639003c2f1c000000ff70657273697374656e7420706f61007d0dfc4a010005b0000000000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
analyselog('F:/presenccia/ubitrack/branches/dtg_demo/participant05.log',3,UCL,DTG,XIM);

%F:/presenccia/ubitrack/branches/dtg_demo/participant06.log
UCL = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000070000000010102000e0000003132382e31362e31332e313639003c2f1c000000ff70657273697374656e7420706f6100f42cfc4a0100088c000000000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
DTG = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003e2f00000e000000fe7515fc4a00005ddd000000000100000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
XIM = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003b2f000010000000ff426964446972504f410031303133390200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
analyselog('F:/presenccia/ubitrack/branches/dtg_demo/participant06.log',6,UCL,DTG,XIM);

%F:/presenccia/ubitrack/branches/dtg_demo/participant07.log
XIM = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003b2f000010000000ff426964446972504f410031303136310200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
DTG = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000068000000010102000f0000003132382e3233322e32332e31343500003e2f00000e000000fe5241fc4a0000729e000000000100000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
UCL = 'IOR:010000001b00000049444c3a556269747261636b2f5562694f626a6563743a312e300000010000000000000070000000010102000e0000003132382e31362e31332e313639003c2f1c000000ff70657273697374656e7420706f61001444fc4a01001584000000000200000000000000080000000100000000545441010000001c00000001000000010001000100000001000105090101000100000009010100'
analyselog('F:/presenccia/ubitrack/branches/dtg_demo/participant07.log',9,UCL,DTG,XIM);

set(gcf, 'PaperPositionMode', 'auto');
orient landscape;
print(gcf, '-r0', 'position_frequency.pdf', '-dpdf');
print(gcf, '-r0', 'position_frequency2.png', '-dpng');
saveas(gcf,'position_frequency.png');
%print_pdf('position_freqency2.pdf',gcf);

function analyselog(file1,ind,ucl,dtg,xim)
fid = fopen(file1);
%[C1,C2,C3,C4,C5,C6,C7,C8,C9,C10,C11,C12,C13,C14,C15,C16,C17,C18,C19,C20,C21,C22] = textread(file1,'%s%s%s%s%s%s%s%s%s%s%s%s%s%s%f%f%f%s%f%f%f%f', 'delimiter',':{}, []');
str = textread(file1,'%s', 'delimiter','\n');
fclose(fid);

timestamp = 0;
count = 0;
plotvalues = zeros(30,75,3);
obj = struct('ior',{},'timestamp',{},'index',{});
x_val = 0; z_val = 0;

for x=1:size(str,1)
    [col1 D1] = strtok(str{x,1},' ');
    if ((isempty(strfind(char(str{x,1}),'Starting')) == 0) || (isempty(strfind(char(str{x,1}),'Stopping')) == 0))
        %start and end of file
        continue; %moves to next record
    end;
    [col2 D1] = strtok(D1,' ');
    [col3 D1] = strtok(D1,' ');
    [col4 D1] = strtok(D1,' ');
    [col5 D1] = strtok(D1,' ');
    [col6 D1] = strtok(D1,' ');
    [col7 D1] = strtok(D1,' ');
    [col8 D1] = strtok(D1,' ');
    [col9 D1] = strtok(D1,' ');
    [col10 D1] = strtok(D1,' ');
    if (isempty(strfind(char(str{x,1}),'adding')) == 0) 
        %if new object is added, extend array to accomodate
        [col11 D1] = strtok(D1,' ');
        if (strcmp(char(col11),ucl) == 1)
            count = 1;
        elseif (strcmp(char(col11),dtg) == 1)
            count = 2;
        elseif (strcmp(char(col11),xim) == 1)
            count = 3;
        end;
        %plotvalues(:,:,count) = 0;
        obj(count).ior = char(col11);
        obj(count).timestamp = str2double(char(col3));
        continue; %moves to next record
    end;
    for r=1:3 
        if (strcmp(obj(r).ior,char(col10)) == 1)
            [col11 D1] = strtok(D1,'[');
            [col12 D1] = strtok(D1,'[,'); %x position
            [col13 D1] = strtok(D1,' ,'); %y position
            [col14 D1] = strtok(D1,' ],'); %z position
            duration = str2double(char(col3)) - obj(r).timestamp;
            obj(r).timestamp = str2double(char(col3));
            if ((str2double(char(col12)) > -1.5) && (str2double(char(col12)) < 1.5) && ...
              (str2double(char(col14)) > -5) && (str2double(char(col14)) < 2.5))
                x_val = ceil((str2double(char(col12))+1.5)*10);
                z_val = ceil((str2double(char(col14))+5)*10);
                plotvalues(x_val,z_val,r) = plotvalues(x_val,z_val,r) + duration;
            end;
            break;
        end;
    end;
end;
for y=1:3
    subplot(4,3,y+ind);
    bar3(plotvalues(:,:,y),0.2,'detached')
    view(-217.5,30);
    if ((ind==0)&&(y==1))
        title('UCL');
    elseif ((ind==0)&&(y==2))
        title('DTG');
    elseif ((ind==0)&&(y==3))
        title('XIM');
    end;
    set(gca,'FontSize',6.5);
    set(gca,'YTickLabel',[-1.5;0;1.5]);
    set(gca,'XTickLabel',[-4;-3;-2;-1;0;1;2]);%[-3.1;-1.3;0.5]
    if ((y+ind==1)||(y+ind==4)||(y+ind==7)||(y+ind==10))
        zlabel('duration(secs)');
    end;
    if ((y+ind>=10)&&(y+ind<=12))
        ylabel('entrance');
        xlabel('towards posters -->');
    end;
end;
save(sprintf('data%d.mat',ind));
clear all;